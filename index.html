<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Open Tal on WhatsApp</title>
    <meta name="description" content="Start chatting with Tal on WhatsApp">
    <meta name="theme-color" content="#ff6b35">

    <!-- Open Graph -->
    <meta property="og:title" content="Chat with Tal">
    <meta property="og:description" content="Your personal career agent on WhatsApp">
    <meta property="og:type" content="website">

    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="card">
        <!-- Tal's Logo -->
        <div class="logo">
            <img src="Tal 2.png" alt="Tal logo">
        </div>

        <h1>LinkedIn is worse on Android.</h1>

        <div class="company-pill" id="companyPill"></div>

        <p class="instruction">You'll have to do this twice. When this pops up, tap <strong>Retry</strong>.</p>

        <!-- Screenshot with animated overlays - wrapped in link -->
        <a href="#" id="screenshotLink">
            <div class="screenshot-container">
                <img src="Screenshot.jpeg" alt="Tap Retry when you see this popup" class="screenshot-img">

                <!-- Scan line animation -->
                <div class="scan-line"></div>

                <!-- Pulsing highlight around Retry button area -->
                <div class="retry-highlight"></div>

                <!-- Animated cursor/hand -->
                <div class="tap-cursor">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="32" height="32">
                        <path d="M13.75 2.5a1.25 1.25 0 0 0-2.5 0v8.25H9.75a1.25 1.25 0 0 0 0 2.5h1.5v1h-1.5a1.25 1.25 0 0 0 0 2.5h1.5v2.5a1.25 1.25 0 0 0 2.5 0v-2.5h1.5a1.25 1.25 0 0 0 0-2.5h-1.5v-1h1.5a1.25 1.25 0 0 0 0-2.5h-1.5V2.5z"/>
                    </svg>
                </div>
            </div>
        </a>

        <a
            href="#"
            class="btn-primary"
            id="whatsappBtn"
            aria-label="Open WhatsApp to chat with Tal"
        >
            Open WhatsApp
        </a>
    </div>

    <script>
        // Configuration
        const WHATSAPP_NUMBER = '919224262682';
        const WHATSAPP_MESSAGE = 'Hi I want to know more about grapevine';

        // Build WhatsApp URLs
        const whatsappUrl = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(WHATSAPP_MESSAGE)}`;
        const whatsappDeepLink = `whatsapp://send?phone=${WHATSAPP_NUMBER}&text=${encodeURIComponent(WHATSAPP_MESSAGE)}`;
        const whatsappIntent = `intent://send?phone=${WHATSAPP_NUMBER}&text=${encodeURIComponent(WHATSAPP_MESSAGE)}#Intent;scheme=whatsapp;package=com.whatsapp;S.browser_fallback_url=${encodeURIComponent(whatsappUrl)};end`;

        // Detect LinkedIn in-app browser
        function isLinkedInBrowser() {
            const ua = navigator.userAgent || navigator.vendor || window.opera;
            return ua.includes('LinkedIn') || ua.includes('LinkedInApp');
        }

        // Detect Android
        function isAndroid() {
            return /android/i.test(navigator.userAgent);
        }

        // Set the href dynamically on page load based on device/browser
        window.addEventListener('load', function() {
            const isLinkedIn = isLinkedInBrowser();
            const isAndroidDevice = isAndroid();
            const whatsappBtn = document.getElementById('whatsappBtn');
            const screenshotLink = document.getElementById('screenshotLink');

            var targetUrl;
            if (isLinkedIn && isAndroidDevice) {
                // LinkedIn Android: Use Intent URL
                targetUrl = whatsappIntent;
                console.log('LinkedIn Android detected - using Intent URL');
            } else if (isAndroidDevice) {
                // Regular Android: Try Intent URL directly
                targetUrl = whatsappIntent;
                console.log('Android detected - using Intent URL');
            } else {
                // iOS/Desktop: Use standard wa.me URL
                targetUrl = whatsappUrl;
                console.log('iOS/Desktop detected - using wa.me URL');
            }

            // Set href on both button and screenshot link
            whatsappBtn.href = targetUrl;
            screenshotLink.href = targetUrl;

            console.log('Page loaded. User Agent:', navigator.userAgent);
            console.log('LinkedIn Browser:', isLinkedIn);
            console.log('Android:', isAndroidDevice);
        });
    </script>
</body>
</html>
